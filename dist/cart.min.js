// Cart.js
// version: 0.0.1
// author: Gavin Ballard
// license: MIT
(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;a={settings:{autoCommit:!1},cart:null},i=[],l=[],k=!1,e=function(b,c,e,f,g){var h;return null==f&&(f="POST"),null==g&&(g="json"),h=i,k&&a.settings.autoCommit&&(h=l),h.push({url:b,data:c,callback:e,type:f,dataType:g}),a.settings.autoCommit?d():void 0},d=function(){return k?void 0:(k=!0,[].push.apply(l,i.splice(0,i.length)),j())},j=function(){var a;return l.length?(a=l.shift(),a.complete=j,jQuery.ajax(a)):void(k=!1)},b=function(a,b,c){var d;null==b&&(b=1),null==c&&(c={}),d=wrapKeys(c,"properties"),d.id=a,d.quantity=b,e("/cart/add.js",d)},q=function(a,b,c){var d;null==b&&(b=1),null==c&&(c={}),d=wrapKeys(c,"properties"),d.line=a,d.quantity=b,e("/cart/change.js",d)},m=function(a){q(a,0)},c=function(){e("/cart/clear.js")},f=function(b,c){return b in a.cart.attributes?a.cart.attributes[b]:c},n=function(a,b){var c;c={},c[a]=b,o(c)},g=function(){return a.cart.attributes},o=function(a){var b;null==a&&(a={}),b=wrapKeys(a),e("/cart/update.js",b)},h=function(){return a.cart.note},p=function(a){e("/cart/update.js",{note:a})},a.factory=function(e){return e._=a,e.settings=a.settings,e.configure=function(b){var c,d;null==b&&(b={});for(c in b)d=b[c],a.settings[c]=d},e.init=function(b,c){null==c&&(c={}),a.cart=b,e.configure(c)},e.commit=d,e.addItem=b,e.removeItem=m,e.updateItem=q,e.clearItems=c,e.getAttribute=f,e.setAttribute=n,e.getAttributes=g,e.setAttributes=o,e.getNote=h,e.setNote=p},"object"==typeof exports?a.factory(exports):"function"==typeof define&&define.amd?define(["exports"],function(b){return a.factory(this.Cart=b),b}):a.factory(this.Cart={})}).call(this);