// Cart.js
// version: 0.0.1
// author: Gavin Ballard
// license: MIT
(function(){var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}};a={settings:{autoCommit:!0},cart:null},a.init=function(b,c){return null==c&&(c={}),a.configure(c),a.cart=new a.Cart(b),a.Rivets.bindElements({cart:a.cart})},a.configure=function(b){var c,d;null==b&&(b={});for(c in b)d=b[c],a.settings[c]=d},a.Utils={wrapKeys:function(a,b){var c,d,e;null==b&&(b="properties"),e={};for(c in a)d=a[c],e[""+b+"["+c+"]"]=d;return e}},c=[],b=!1,a.Queue={add:function(d,e,f,g,h){return null==g&&(g="POST"),null==h&&(h="json"),c.push({url:d,data:e,success:f,type:g,dataType:h}),b?void 0:(jQuery(document).trigger("cart.requestStarted"),a.Queue.process())},process:function(){var d;return c.length?(b=!0,d=c.shift(),d.complete=a.Queue.process,jQuery.ajax(d)):(b=!1,void jQuery(document).trigger("cart.requestComplete"))}},a.Cart=function(){function b(a){this.update=d(this.update,this),this.update(a)}return b.prototype.update=function(b){var c,d,e;for(d in b)e=b[d],"items"!==d&&(this[d]=e);return this.items=function(){var d,e,f,g;for(f=b.items,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(new a.Item(c));return g}()},b}(),a.Item=function(){function a(a){this.update=d(this.update,this),this.update(a)}return a.prototype.update=function(a){var b,c,d;d=[];for(b in a)c=a[b],d.push(this[b]=c);return d},a}(),a.Core={getCart:function(){return a.Queue.add("/cart.js",{},a.cart.update,"GET")},addItem:function(b,c,d){var e;return null==c&&(c=1),null==d&&(d={}),e=a.Utils.wrapKeys(d),e.id=b,e.quantity=c,a.Queue.add("/cart/add.js",e),a.Core.getCart()},updateItem:function(b,c,d){var e;return null==c&&(c=1),null==d&&(d={}),e=a.Utils.wrapKeys(d),e.line=b,e.quantity=c,a.Queue.add("/cart/change.js",e,a.cart.update)},removeItem:function(b){return a.Core.updateItem(b,0)},clear:function(){return a.Queue.add("/cart/clear.js",{},a.cart.update)},getAttribute:function(b,c){return b in a.cart.attributes?a.cart.attributes[b]:c},setAttribute:function(a,b){var c;return c={},c[a]=b,setAttributes(c)},getAttributes:function(){return a.cart.attributes},setAttributes:function(b){return null==b&&(b={}),a.Queue.add("/cart/update.js",a.Utils.wrapKeys(b,"attributes"),a.cart.update)},getNote:function(){return a.cart.note},setNote:function(b){return a.Queue.add("/cart/update.js",{note:b},a.cart.update)}},"rivets"in window?(a.Rivets={views:[],bindElements:function(b){return a.Rivets.unbindElements(),jQuery("[data-cart-view]").each(function(){return a.Rivets.views.push(rivets.bind(this,b))})},unbindElements:function(){var b,c,d,e;for(e=a.Rivets.views,c=0,d=e.length;d>c;c++)b=e[c],b.unbind();return a.Rivets.views=[]}},rivets.formatters.lt=function(a,b){return b>a},rivets.formatters.gt=function(a,b){return a>b},"Shopify"in window&&"formatMoney"in window.Shopify&&(rivets.formatters.money=function(b){return Shopify.formatMoney(b,a.settings.money_format)},rivets.formatters.money_with_currency=function(b){return Shopify.formatMoney(b,a.settings.money_with_currency_format)})):a.Rivets={bindElements:function(){},unbindElements:function(){}},a.factory=function(b){return b._=a,b.init=a.init,b.configure=a.configure,b.settings=a.settings,b.getCart=a.Core.getCart,b.addItem=a.Core.addItem,b.updateItem=a.Core.updateItem,b.removeItem=a.Core.removeItem,b.clear=a.Core.clear,b.getAttribute=a.Core.getAttribute,b.setAttribute=a.Core.setAttribute,b.getAttributes=a.Core.getAttributes,b.setAttributes=a.Core.setAttributes,b.getNote=a.Core.getNote,b.setNote=a.Core.setNote},"object"==typeof exports?a.factory(exports):"function"==typeof define&&define.amd?define(["exports"],function(b){return a.factory(this.CartJS=b),b}):a.factory(this.CartJS={})}).call(this);